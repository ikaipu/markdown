# サロン予約システム管理者マニュアル # 

本ドキュメントはサロン予約システム管理者向けのマニュアルです。

1. サロンデータ登録手順 
1. エンドユーザー利用手順

## サロンデータ登録手順 ##

以下の手順でデータを登録します。

1. Google カレンダーへのデータ登録
    1. カレンダーの作成
    1. 営業時間情報の登録
    1. スタッフ休日、休憩情報の登録
1. Firebase Storage へのイメージのアップロード
1. Firebase Database へのデータ登録
    1. JSONオブジェクトの作成
    1. 作成したJSONのインポート

### Googleカレンダーへのデータ登録 ###
営業時間やスタッフの休日などの情報を Google カレンダーに登録します。

1. サロン管理用アカウントで Google カレンダーへログインする。

2. 以下のカレンダーを登録する。
    - サロン営業時間用カレンダー 
    - スタッフカレンダー（各スタッフ毎）

<img width="400px" src="https://user-images.githubusercontent.com/18732551/32164705-44a60bb8-bd9b-11e7-8d42-a920d3ef53c7.png">

登録されたカレンダーのカレンダーIDを後ほどデータベースに登録する必要があります。（後述）

3. サロン営業時間用カレンダーでサロンの営業時間を設定する。  
予定名、説明などの付加情報は任意に設定可能です。

<img width="700px" src=https://user-images.githubusercontent.com/18732551/32165150-c9c9ed68-bd9c-11e7-9db3-4a52f0753de3.png>

4. スタッフのカレンダーごとに休憩時間、休日を設定する。
予定名、説明などの付加情報は任意に設定可能です。  
※スタッフの休日を設定する際は開始時間、終了時間を営業時間と合わせて下さい。終日として登録してもシステムに反映されないのでご注意下さい。
<img width="700px" src=https://user-images.githubusercontent.com/18732551/32165544-15ad7744-bd9e-11e7-8a7d-a8bfd15f510d.png>

### Firebase Storage へのイメージのアップロード ###
アイコン、スタッフの写真などの必要な写真をアップロードします。
以下のイメージを登録する必要があります。
- ファビコン
- バナー
- アイコンロゴ
- 各スタッフの写真

1. Firebase コンソールにログインし、プロジェクトを選択する。

2. 左サイドメニューから Storage を選択する。

3. イメージをアップロードする。  
任意のディレクトリ構成で配置可能です。

<img width="500px" src=https://user-images.githubusercontent.com/18732551/32167617-64e92028-bda4-11e7-811f-9278e715fdaf.png>

登録されたイメージの URL を後ほどデータベースに登録する必要があります。（後述）

### Firebase Database へのデータ登録 ###
サロンのデータを Firebase Database へ登録します。 
Firebase Database の構造は JSON 形式で記述されています。  
JSON についての詳細は省略します。

1. Firebase コンソールにログインし、プロジェクトを選択する。

2. 左サイドメニューから Database を選択する。

3. 既存のデータベースデータをバックアップする。  
データ編集前に有事の際のデータバックアップをおすすめします。  
中央ペイン右上の編集ボタン -> Export JSON

<img width="600px" src=https://user-images.githubusercontent.com/18732551/32168841-109fe29a-bda9-11e7-8e85-69472eaa43c5.png>

4. 以下のようなフォームで記述します。

```
{
  "contracts" : {　　<--- 固定
    "**契約ID**" : {
      "en" : {  <---　英語用データ 
        "bannerImageUrl" : "**バナーイメージのURL**",  <---　取得方法は後述
        "businessHours" : {  <---　営業時間の表示
          "fri" : {  <---　　金曜日
            "end" : "**終了時間**",
            "start" : "**開始時間**"
          },
          "mon" : {  <---　　月曜日
            "closed" : true　　<--- 休みの場合
          },
          "sat" : {  <---　　土曜日
            "end" : "**終了時間**",
            "start" : "**開始時間**"
          },
          "sun" : {  <---　　日曜日
            "end" : "**終了時間**",
            "start" : "**開始時間**"
          },
          "thu" : {  <---　　木曜日
            "end" : "**終了時間**",
            "start" : "**開始時間**"
          },
          "tue" : {  <---　　火曜日
            "end" : "**終了時間**",
            "start" : "**開始時間**"
          },
          "wed" : {  <---　　水曜日
            "end" : "**終了時間**",
            "start" : "**開始時間**"
          }
        },
        "calendarId" : "営業時間用カレンダーID",  <---　取得方法は後述
        "categories" : [ {　　　　<--- 上限なしで複数カテゴリを登録可能　（ただし、タブの表示の関係上４つ以下をおすすめします）。
          "id" : "**カテゴリID**",  <--- 一意である必要がある
          "menus" : [ {　　<--- 上限なしで一つのカテゴリ内に複数メニューを登録可能。
            "duration" : **施術時間(h)**,  <--- 0.5の倍数で記入可。選ばれたメニューの合計がスタッフの施術時間になります。
            "id" : "**メニューID**",  <--- 一意である必要がある
            "name" : "**メニュー名**",   
            "price" : **価格**
          }, {
            <=========== メニュー　２ ===========>
          }, 

          ...

          {
            <=========== メニュー n ===========>
          } ],　
          "name" : "**カテゴリ名**"
        }, {
          <=========== カテゴリ 2 ===========>
        },

        ...

　　　　　　　　　　　　　　　　{
          <=========== カテゴリ n ===========>
        } ],
        "description" : "サロン概要（文章）",
        "faviconUrl" : "**ファビコンのURL**",  <---　取得方法は後述
        "id" : "**契約ID**", <--- 上部の契約IDと統一する
        "lang" : "en",　<--- en or ja
        "logoImageUrl" :  "**ロゴイメージのURL**",  <---　取得方法は後述
        "moneySymbol" : "**通貨マーク**",　<---　取得方法は後述
        "phoneNumber" : "**電話番号**", <---　ハイフン可
        "stuff" : [ {　　<--- 上限なしでスタッフを登録可能。
          "calendarId" : "**スタッフカレンダーID**",  <---　取得方法は後述
          "description" : "**スタッフ紹介文**",
          "id" : "**スタッフID**",  <--- 一意である必要がある
          "imageUrl" :  "**スタッフイメージのURL**",  <---　取得方法は後述
          "name" : "** スタッフ名 **"
        }, {
          <=========== スタッフ 2 ===========>
        },

        ...

　　　　　　　　　　　　　　　　{
          <=========== スタッフ n ===========>
        } ], ],
      },
      "ja" : {
        <=========== 日本語用データ ===========>
      }
    },
    "**契約ID2**" : {
      <=========== 略 ===========>
    },

    ...

    "**契約IDn**" : {
      <=========== 略 ===========>
    }
  }
}
```

5. 作成したJSONをデータベースにアップロードする。   
中央ペイン右上の編集ボタン -> Import JSON

<img width="600px" src=https://user-images.githubusercontent.com/18732551/32170680-80954afc-bdb0-11e7-90e3-31a03ccaa594.png>

#### カレンダーIDの取得方法 ####
 
Google カレンダーの　設定アイコン -> Settings -> Calendars タブ -> カレンダー名をクリック -> Calendar Address　欄から取得できます。 
 
<img width="600px" src=https://user-images.githubusercontent.com/18732551/32166216-19de6506-bda0-11e7-97bf-1e16e0245671.png>

カレンダーIDから 「@group.calendar.google.com」を取り除いたものが必要な情報になります。  
例)  
```abcdefjhijklmnop0123456789@group.calendar.google.com　-> abcdefjhijklmnop0123456789```

#### イメージURLの取得方法 ####

Firebase Storage コンソールから対象のイメージを選択し、右ペインの Download URL から取得できます。

<img width="200px" src=https://user-images.githubusercontent.com/18732551/32168001-d03bba1a-bda5-11e7-8497-9e310b14d545.png>